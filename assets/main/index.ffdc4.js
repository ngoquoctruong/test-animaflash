window.__require=function e(t,i,o){function n(r,l){if(!i[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var c="function"==typeof __require&&__require;if(!l&&c)return c(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var u=i[r]={exports:{}};t[r][0].call(u.exports,function(e){return n(t[r][1][e]||e)},u,u.exports,e,t,i,o)}return i[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)n(o[r]);return n}({1:[function(e,t){var i=e("./package.json").version,o="en",n="jp",a={jp:{play:"\u30b9\u30bf\u30fc\u30c8"},en:{play:"Play Now!"}},r=500;function l(){console.log("H5ad v"+i),this._isInitialised=!1,this._splashAdShown=!1}function s(e){for(var t in e=e||{})void 0===e[t]&&delete e[t];return e}function c(e,t){console.error(e),(t=t||{}).noBreak?t.noBreak():(t.beforeBreak&&t.beforeBreak(),t.afterBreak&&t.afterBreak())}function u(){if(!navigator.language)return n;var e=navigator.language.toLowerCase().substr(0,2);return a[e]?e:o}l.prototype.initialize=function(e){if(this._isInitialised)console.warn("h5ad: already initialized");else{this._isInitialised=!0,e&&void 0!==e.adBreakTimeout&&(r=e.adBreakTimeout),adConfig=window.adConfig=function(){};var t=document.createElement("script");t.src="https://html5gameportal.com/embeds/wortal-1.0.0.js",t.async=!0,document.head.appendChild(t),t.addEventListener("load",()=>{window.initWortal(function(){adConfig({preloadAdBreaks:"on",sound:"on"}),console.log("Wortal setup complete!")})})}},l.prototype.onStart=function(e){if(e=e||{},this._isInitialised||this.initialize({adBreakTimeout:e.adBreakTimeout}),this._splashAdShown)console.warn("h5ad: onStart has already been called");else{this._splashAdShown=!0;var t="";t+=".splahContainer {",t+="    background-color: black;",t+="    position: absolute;",t+="    width: 100%;",t+="    height: 100%;",t+="    text-align: left;",t+="}",t+=".splahContainer .gameIcon {",t+="    position: relative;",t+="    width: 100px;",t+="    height: 100px;",t+="    background-size: 100%;",t+="    transform: translate(-50%, -100%);",t+="    left: 50%;",t+="    top: 31%;",t+="    border-radius: 10px;",t+="    border: 2px white solid;",t+="    border-radius: min(2vh,2vw);",t+="    border: min(0.7vw, 0.7vh) white solid;",t+="    width: min(30vw, 20vh);",t+="    height: min(30vw, 20vh);",t+="}",t+=".splahContainer .startButton {",t+="    background-color: rgb(255, 193, 7);",t+="    padding: 20px 30px;",t+="    border-radius: 13px;",t+="    transform: translate(-50%, 100%);",t+="    left: 50%;",t+="    top: 40%;",t+="    border: 5px solid white;",t+="    position: relative;",t+="    cursor: pointer;",t+="    font-size: 26px;",t+="    font-family: arial, verdana;",t+="    color: white;",t+="    text-align: center;",t+="    transition: all 0.1s;",t+="    width: min(50vw,27vh);",t+="    padding: min(3vw,3vh);",t+="    font-size: min(4vh,9vw);",t+="    border-radius: min(2vh,2vw);",t+="    border: min(1vw, 1vh) white solid;",t+="}",t+=".splahContainer .startButton:hover {",t+="    transform: translate(-50%, 100%) scale(1.1);",t+="    background-color: rgb(255 217 104);",t+="}";var i=document.createElement("style");i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),document.getElementsByTagName("head")[0].appendChild(i);var o=document.createElement("div");e.color&&(o.style.backgroundColor=e.color),o.className="splahContainer";var n=document.createElement("div");n.textContent=a[u()].play,n.className="startButton",o.appendChild(n);var l=document.createElement("div");l.className="gameIcon",e.icon&&(l.style.backgroundImage="url("+e.icon+")"),o.appendChild(l),document.body.appendChild(o),n.onclick=function(){afterBreakCallbackCalled=!1;var t=setTimeout(function(){afterBreakCallbackCalled||(afterBreakCallbackCalled=!0,e.afterBreak&&e.afterBreak())},r);try{adBreak(s({type:"start",name:e.name||"splash_screen",beforeAd:function(){clearTimeout(t)},afterAd:function(){afterBreakCallbackCalled||(afterBreakCallbackCalled=!0,e.afterBreak&&e.afterBreak())}}))}catch(i){c(i,e)}setTimeout(function(){document.body.removeChild(o)},200)}}},l.prototype.onNext=function(e){(e=e||{}).type="next",this.adBreak(e)},l.prototype.onBrowse=function(e){(e=e||{}).type="browse",this.adBreak(e)},l.prototype.onPause=function(e){(e=e||{}).type="pause",this.adBreak(e)},l.prototype.onReward=function(e){(e=e||{}).type="reward",this.adBreak(e)},l.prototype.adBreak=function(e){var t,i=(e=e||{}).type;if(-1===["next","browse","pause","reward"].indexOf(i))return console.error("H5ad: unknown type",i);t=setTimeout(function(){e.noBreak&&e.noBreak()},r);try{adBreak(s({type:i,name:e.name||i,beforeAd:function(){t&&clearTimeout(t),e.beforeBreak&&e.beforeBreak()},afterAd:e.afterBreak,beforeReward:e.beforeReward,adDismissed:"reward"===i?e.adDismissed||function(){}:void 0,adViewed:e.adViewed}))}catch(o){c(o,e)}},l.prototype.onMute=function(){adConfig({sound:"off"})},l.prototype.onUnmute=function(){adConfig({sound:"on"})},t.exports=new l},{"./package.json":2}],2:[function(e,t){t.exports={name:"h5ad",version:"1.1.3",description:"Ad API wrapper for GC Turbo hyper casual games",main:"index.js",scripts:{},repository:{type:"git",url:"git+https://github.com/gc-turbo/h5ad.git"},author:"GC Turbo",license:"",bugs:{url:"https://github.com/gc-turbo/h5ad/issues"},homepage:"https://github.com/gc-turbo/h5ad#readme"}},{}],BoardCtor:[function(e,t){"use strict";cc._RF.push(t,"0ea50FT3DVG2K3QWJ/jwsKD","BoardCtor");var i=r(e("./constants")),o=r(e("./libs/helpers")),n=r(e("./objects/Tile")),a=r(e("./EffectorCtor"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{hintNode1:cc.Node,hintNode2:cc.Node,tilePrefab:cc.Prefab,effectorCtor:a.default},onLoad:function(){this.tilePool=new cc.NodePool("tile"),this.ingameCtor=this.getComponent("IngameCtor"),this.soundController=this.ingameCtor.soundController,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouch,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnded,this)},update:function(e){if(this.ingameCtor.isPlaying&&!this.isHintShowing&&(this.hintCountdown-=e,this.hintCountdown<0)){var t=this.currentPossibleMoves[~~(Math.random()*this.currentPossibleMoves.length)];this.showHint(t.toMove,t.moveTo)}},init:function(){this.board=[],window.board=this.board,this.cellList=[],this.justSwappedCells=[],this.stopHint();for(var e=0;e<i.default.BOARD_ROW_SIZE;e++){for(var t=[],o=0;o<i.default.BOARD_COLUMN_SIZE;o++){var n={x:o,y:e,tile:null};t.push(n),this.cellList.push(n)}this.board.push(t)}},reshuffleBoard:function(){var e=this;this.ingameCtor.uiController.showReshuffleNotification(),this.scheduleOnce(function(){e.animateReshuffleBoard(),e.scheduleOnce(e.generateTiles.bind(e,!1,!1),i.default.ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW+i.default.ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW*i.default.BOARD_ROW_SIZE)},i.default.ANIMATE_DURATION_NOTIF_SHOW+i.default.ANIMATE_DURATION_NOTIF_WAIT)},generateTiles:function(e,t){var o=this,n=[],a=i.default.BOARD_ROW_SIZE;this.cellList.forEach(function(r){null===r.tile&&(o.createTile(r,e?i.default.TUTORIAL_LAYOUT[r.y][r.x]:t?-2:-1),n.push(r),a=Math.min(a,r.y))}),this.animateDropGeneratedTiles(n,a),this.scheduleOnce(this.adjoinTiles.bind(this,null,"normal"),i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW+i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW*(i.default.BOARD_ROW_SIZE-a))},createTile:function(e,t){if(this.tilePool.size()<=0){var o=cc.instantiate(this.tilePrefab);this.tilePool.put(o)}var a,r=this.tilePool.get(),l=r.getComponent(n.default);if(r.parent=this.node,a=t>=0?t:~~(Math.random()*i.default.TILE_TYPE_NORMAL_NUMBER),-2===t)for(var s=a;!this.checkforInitValidity(a,e);)if((a=(a+1)%i.default.TILE_TYPE_NORMAL_NUMBER)===s)return cc.error("check validity failed"),!1;return l.setup(a,e),e.tile=l,!0},swapTileAtCell:function(e,t){if(this.ingameCtor.isInTutorial){var o=this.board[i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][0].y][i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][0].x],n=this.board[i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][1].y][i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][1].x];if(e===o&&t===n);else if(e!==n||t!==o)return}this.currentChain=0,this.ingameCtor.pauseGameForAnimating(),this.stopHint(),this.ingameCtor.tutorialStep++,window.tutorial=!this.ingameCtor.isInTutorial;for(var a=!1,r=0;r<this.currentPossibleMoves.length;r++){var l=this.currentPossibleMoves[r];if(l.toMove===e&&l.moveTo===t||l.toMove===t&&l.moveTo===e){a=!0;break}}if(a){var s=e.tile;e.tile=t.tile,t.tile=s,this.justSwappedCells=[e,t],this.animateSwap(e,t)}else this.animateSwapForthBack(e,t);this.scheduleOnce(this.activateSpecicalTiles.bind(this,e,t),a?i.default.ANIMATE_DURATION_SWAP:2*i.default.ANIMATE_DURATION_SWAP)},activateSpecicalTiles:function(e,t){var o=null,n=null;e.tile.type>=i.default.TILE_TYPE_NORMAL_NUMBER?e.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_MATCH&&t.tile.type>=i.default.TILE_TYPE_NORMAL_NUMBER?(o=t,n=e):e.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_TIME&&t.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_LINE?(o=t,n=e):(o=e,n=t):t.tile.type>=i.default.TILE_TYPE_NORMAL_NUMBER&&(o=t,n=e),null===o?this.adjoinTiles(null,"normal"):o.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_LINE?this.activateLineTile(o,n):o.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_TIME?this.activateTimeTile(o,n):o.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_MATCH?this.activateMatchTile(o,n):this.adjoinTiles(null,"normal")},activateLineTile:function(e,t){var o=[];if(t.x===e.x)for(var n=0;n<i.default.BOARD_ROW_SIZE;n++)o.push(this.board[n][e.x]);else for(n=0;n<i.default.BOARD_COLUMN_SIZE;n++)o.push(this.board[e.y][n]);this.adjoinTiles(o,"line")},activateTimeTile:function(e,t){var i=[e,t];this.adjoinTiles(i,"time")},activateMatchTile:function(e,t){var i=[];i.push(e),this.cellList.forEach(function(e){e.tile&&e.tile.type===t.tile.type&&i.push(e)}),this.adjoinTiles(i,"match")},adjoinTiles:function(e,t){void 0===e&&(e=null);var o=this.gatherAdjoinedLines(),n=this.gatherAdjoinedSpecialSpawns(o);this.justSwappedCells=[],o.length>0||e?(e&&o.push(e),this.scoring(o,t,e),this.animateAdjoin(o,t),n.length>0?this.scheduleOnce(this.spawnSpecialTiles.bind(this,n),i.default.ANIMATE_DURATION_ADJOIN):this.scheduleOnce(this.dropTiles,i.default.ANIMATE_DURATION_ADJOIN)):!this.ingameCtor.checkForLevelCompleted()||this.ingameCtor.isInTutorial?(this.currentPossibleMoves=this.gatherPossibleMoves(),0===this.currentPossibleMoves.length&&this.ingameCtor._time>0?this.reshuffleBoard():(this.ingameCtor.resumeGameFromAnimating(),this.ingameCtor.isInTutorial?this.showHint(this.board[i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][0].y][i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][0].x],this.board[i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][1].y][i.default.TUTORIAL_MOVES[this.ingameCtor.tutorialStep][1].x]):this.startHintCountdown())):this.ingameCtor.nextLevel()},startHintCountdown:function(){this.isHintShowing=!1,this.hintCountdown=i.default.TILE_HINT_SHOWUP_TIME},showHint:function(e,t){this.isHintShowing=!0,this.hintTween&&this.hintTween.stop(),this.hintNode1.active=!0,this.hintNode2.active=!0,o.default.localPositionFromTileCoords((e.x+t.x)/2,(e.y+t.y)/2),this.hintNode1.position=o.default.localPositionFromTileCoords(e.x,e.y),this.hintNode2.position=o.default.localPositionFromTileCoords(t.x,t.y),this.hintNode1.scale=0,this.hintNode2.scale=0,this.hintTween1=cc.tween(this.hintNode1).parallel(cc.tween().to(.5,{scale:1}),cc.tween().repeatForever(cc.tween().by(5,{angle:360}))).start(),this.hintTween2=cc.tween(this.hintNode2).parallel(cc.tween().to(.5,{scale:1}),cc.tween().repeatForever(cc.tween().by(5,{angle:360}))).start()},stopHint:function(){var e=this;this.hintTween1||this.hintTween2?(cc.tween(this.hintNode1).to(.1,{scale:0}).call(function(){e.hintNode1.active=!1,e.hintTween1.stop()}).start(),cc.tween(this.hintNode2).to(.1,{scale:0}).call(function(){e.hintNode2.active=!1,e.hintTween2.stop()}).start()):(this.hintNode1.active=!1,this.hintNode2.active=!1)},scoring:function(e,t,n){var a=this;void 0===n&&(n=null);var r=o.default.getScoreScale(this.currentChain);n=n||[];var l=[];e.forEach(function(e){e.forEach(function(e){if(!l.includes(e)&&e.tile){l.push(e);var s=o.default.localPositionFromTileCoords(e.x,e.y);if(e.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_TIME)a.effectorCtor.addTimeBonusFx(s,i.default.TILE_SPECIAL_BONUS_TIME,function(){a.ingameCtor.addTime(i.default.TILE_SPECIAL_BONUS_TIME),a.soundController.play(a.soundController.timeAdjoinClip)});else{var c=r;"line"!==t&&"match"!==t||!n.includes(e)||(c=i.default.SPECIAL_SCORING),a.ingameCtor.addScore(c);var u=cc.v2(s.x+a.effectorCtor.translatedBoardPos.x,s.y+a.effectorCtor.translatedBoardPos.y);a.effectorCtor.addScoreFx(u,"score",c)}}})}),this.currentChain++},spawnSpecialTiles:function(e){var t=this,o=[];e.time.forEach(function(e){null===e.tile&&(t.createTile(e,i.default.TILE_TYPE_INDEX_SPECIAL_TIME),o.push(e))}),e.line.forEach(function(e){null===e.tile&&(t.createTile(e,i.default.TILE_TYPE_INDEX_SPECIAL_LINE),o.push(e))}),e.match.forEach(function(e){null===e.tile&&(t.createTile(e,i.default.TILE_TYPE_INDEX_SPECIAL_MATCH),o.push(e))}),o.forEach(function(e){var t=e.tile;t.node.scale=0,cc.tween(t.node).to(2*i.default.ANIMATE_DURATION_SPAWN_SPECIAL,{scale:{value:t.getDefaultScale(),easing:"sineOut"}}).start()}),this.dropTiles()},dropTiles:function(){var e=this.calculateDropTiles();this.animateDropTiles(e),this.scheduleOnce(this.generateTiles.bind(this,!1,!1),i.default.ANIMATE_DURATION_DROP_TILES)},checkforInitValidity:function(e,t){return!(t.x>=2&&this.board[t.y][t.x-1].tile&&this.board[t.y][t.x-2].tile&&this.board[t.y][t.x-1].tile.type===e&&this.board[t.y][t.x-2].tile.type===e||t.y>=2&&this.board[t.y-1][t.x].tile&&this.board[t.y-2][t.x].tile&&this.board[t.y-1][t.x].tile.type===e&&this.board[t.y-2][t.x].tile.type===e)},calculateDropTiles:function(){for(var e=[],t=0;t<i.default.BOARD_COLUMN_SIZE;t++)for(var o=0;o<i.default.BOARD_ROW_SIZE;o++)if(null===this.board[o][t].tile)for(var n=o+1;n<i.default.BOARD_ROW_SIZE;n++)if(null!==this.board[n][t].tile){this.board[o][t].tile=this.board[n][t].tile,this.board[n][t].tile=null,this.board[o][t].tile.cell=this.board[o][t],e.push(this.board[o][t]);break}return e},gatherPossibleMoves:function(){var e=this,t=[];return this.cellList.forEach(function(o){var n=o.x,a=o.y,r=null,l=e.getTileTypeAtCell(n,a);if(l>=i.default.TILE_TYPE_NORMAL_NUMBER)null!==(r=e.getTileTypeAtCell(n-1,a))&&t.push({toMove:e.board[a][n-1],moveTo:o,type:r}),null!==(r=e.getTileTypeAtCell(n+1,a))&&t.push({toMove:e.board[a][n+1],moveTo:o,type:r}),null!==(r=e.getTileTypeAtCell(n,a-1))&&t.push({toMove:e.board[a-1][n],moveTo:o,type:r}),null!==(r=e.getTileTypeAtCell(n,a+1))&&t.push({toMove:e.board[a+1][n],moveTo:o,type:r});else{if(null!==(r=e.getTileTypeAtCell(n-1,a))&&r!==l&&l<i.default.TILE_TYPE_NORMAL_NUMBER){var s=!1;e.getTileTypeAtCell(n+1,a)===r&&e.getTileTypeAtCell(n+2,a)===r?s=!0:e.getTileTypeAtCell(n,a-1)===r&&e.getTileTypeAtCell(n,a-2)===r?s=!0:e.getTileTypeAtCell(n,a-1)===r&&e.getTileTypeAtCell(n,a+1)===r?s=!0:e.getTileTypeAtCell(n,a+1)===r&&e.getTileTypeAtCell(n,a+2)===r&&(s=!0),s&&t.push({toMove:e.board[a][n-1],moveTo:o,type:r})}if(null!==(r=e.getTileTypeAtCell(n+1,a))&&r!==l&&l<i.default.TILE_TYPE_NORMAL_NUMBER){var c=!1;e.getTileTypeAtCell(n-1,a)===r&&e.getTileTypeAtCell(n-2,a)===r?c=!0:e.getTileTypeAtCell(n,a-1)===r&&e.getTileTypeAtCell(n,a-2)===r?c=!0:e.getTileTypeAtCell(n,a-1)===r&&e.getTileTypeAtCell(n,a+1)===r?c=!0:e.getTileTypeAtCell(n,a+1)===r&&e.getTileTypeAtCell(n,a+2)===r&&(c=!0),c&&t.push({toMove:e.board[a][n+1],moveTo:o,type:r})}if(null!==(r=e.getTileTypeAtCell(n,a-1))&&r!==l&&l<i.default.TILE_TYPE_NORMAL_NUMBER){var u=!1;e.getTileTypeAtCell(n,a+1)===r&&e.getTileTypeAtCell(n,a+2)===r?u=!0:e.getTileTypeAtCell(n-1,a)===r&&e.getTileTypeAtCell(n-2,a)===r?u=!0:e.getTileTypeAtCell(n-1,a)===r&&e.getTileTypeAtCell(n+1,a)===r?u=!0:e.getTileTypeAtCell(n+1,a)===r&&e.getTileTypeAtCell(n+2,a)===r&&(u=!0),u&&t.push({toMove:e.board[a-1][n],moveTo:o,type:r})}if(null!==(r=e.getTileTypeAtCell(n,a+1))&&r!==l&&l<i.default.TILE_TYPE_NORMAL_NUMBER){var d=!1;e.getTileTypeAtCell(n,a-1)===r&&e.getTileTypeAtCell(n,a-2)===r?d=!0:e.getTileTypeAtCell(n-1,a)===r&&e.getTileTypeAtCell(n-2,a)===r?d=!0:e.getTileTypeAtCell(n-1,a)===r&&e.getTileTypeAtCell(n+1,a)===r?d=!0:e.getTileTypeAtCell(n+1,a)===r&&e.getTileTypeAtCell(n+2,a)===r&&(d=!0),d&&t.push({toMove:e.board[a+1][n],moveTo:o,type:r})}}}),t},gatherAdjoinedLines:function(){for(var e=this,t=[],o=[],n=[],a=0;a<i.default.BOARD_ROW_SIZE;a++){for(var r=[],l=0;l<i.default.BOARD_COLUMN_SIZE;l++)r.push({vertical:!1,horizonal:!1});n.push(r)}return this.cellList.forEach(function(a){var r=a.tile.type;if(r<i.default.TILE_TYPE_NORMAL_NUMBER){if(!n[a.y][a.x].horizonal&&e.getTileTypeAtCell(a.x+1,a.y)===r&&e.getTileTypeAtCell(a.x+2,a.y)===r){var l=[a,e.board[a.y][a.x+1],e.board[a.y][a.x+2]];n[a.y][a.x+1].horizonal=!0,n[a.y][a.x+2].horizonal=!0;for(var s=a.x+3;e.getTileTypeAtCell(s,a.y)===r;)n[a.y][s].horizonal=!0,l.push(e.board[a.y][s]),s++;t.push(l)}if(!n[a.y][a.x].vertical&&(n[a.y][a.x].vertical=!0,e.getTileTypeAtCell(a.x,a.y+1)===r&&e.getTileTypeAtCell(a.x,a.y+2)===r)){l=[a,e.board[a.y+1][a.x],e.board[a.y+2][a.x]],n[a.y+1][a.x].vertical=!0,n[a.y+2][a.x].vertical=!0;for(var c=a.y+3;e.getTileTypeAtCell(a.x,c)===r;)n[c][a.x].vertical=!0,l.push(e.board[c][a.x]),c++;o.push(l)}}}),t.concat(o)},gatherAdjoinedSpecialSpawns:function(e){for(var t=[],i=[],o=[],n=0;n<e.length;n++)for(var a=n+1;a<e.length;a++){for(var r=!1,l=0;l<e[n].length;l++)if(e[a].includes(e[n][l])){t.push(e[n][l]),r=!0;break}if(r)break}for(n=0;n<e.length;n++)if(e[n].length>=5){var s=this.localeSpawnCell(e[n],t);s&&i.push(s)}else if(4===e[n].length){var c=this.localeSpawnCell(e[n],t);c&&o.push(c)}return{time:t,line:o,match:i,length:t.length+o.length+i.length}},localeSpawnCell:function(e,t){for(var i=0,o=!1,n=0;n<this.justSwappedCells.length;n++)if(e.includes(this.justSwappedCells[n])){i=e.indexOf(this.justSwappedCells[n]),o=!0;break}o||(i=~~(Math.random()*e.length));for(var a=i;a<e.length+i;a++){var r=i%e.length;if(!t.includes[e[r]])return e[r]}return null},getTileTypeAtCell:function(e,t){return e<0||e>=i.default.BOARD_COLUMN_SIZE?null:t<0||t>=i.default.BOARD_ROW_SIZE?null:null===this.board[t][e].tile?null:this.board[t][e].tile.type},animateSwap:function(e,t){var n=o.default.localPositionFromTileCoords(e.x,e.y),a=o.default.localPositionFromTileCoords(t.x,t.y);this.soundController.play(this.soundController.swapClip),cc.tween(e.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(n.x,n.y)}).start(),cc.tween(t.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(a.x,a.y)}).start()},animateSwapForthBack:function(e,t){var n=this,a=o.default.localPositionFromTileCoords(e.x,e.y),r=o.default.localPositionFromTileCoords(t.x,t.y);this.soundController.play(this.soundController.swapClip),cc.tween(e.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(r.x,r.y)}).call(function(){n.soundController.play(n.soundController.swapClip)}).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(a.x,a.y)}).start(),cc.tween(t.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(a.x,a.y)}).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(r.x,r.y)}).start()},animateAdjoin:function(e,t){var o=this;"normal"===t||"time"===t?this.soundController.play(this.soundController.adjoinClip):"match"!==t&&"line"!==t||this.soundController.play(this.soundController.specialAdjoinClip),e.forEach(function(e){e.forEach(function(e){if(null!==e.tile){var t=e.tile;e.tile=null,cc.tween(t.node).to(i.default.ANIMATE_DURATION_ADJOIN,{scale:{value:0,easing:"sineOutIn"}}).call(function(){o.tilePool.put(t.node)}).start()}})})},animateDropTiles:function(e){var t=this;e.forEach(function(e){var n=o.default.localPositionFromTileCoords(e.x,e.y);cc.tween(e.tile.node).to(i.default.ANIMATE_DURATION_DROP_TILES,{position:cc.v2(n.x,n.y)}).call(function(){t.soundController.play(t.soundController.dropClip)}).start()})},animateDropGeneratedTiles:function(e,t){var n=this;e.forEach(function(e){var a=e.tile;a.node.y=Math.max(a.node.y+200,390);var r=o.default.localPositionFromTileCoords(e.x,e.y);cc.tween(a.node).delay(i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW*(e.y-t)).to(i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW,{position:cc.v2(r.x,r.y)}).call(function(){n.soundController.play(n.soundController.dropClip)}).start()})},animateReshuffleBoard:function(){var e=this;this.cellList.forEach(function(t){if(t.tile){var n=t.tile;t.tile=null;var a=o.default.localPositionFromTileCoords(t.x,t.y);cc.tween(n.node).delay(i.default.ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW*t.y).to(i.default.ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW,{position:cc.v2(a.x,Math.min(a.y-200,-290)),opacity:0}).call(function(){e.tilePool.put(n.node)}).start()}})},onTouch:function(e){if(this.ingameCtor.isPlaying){var t=this.node.convertToNodeSpaceAR(e.getLocation()),i=o.default.tileCoordsFromlocalPosition(t.x,t.y);i.spriteInBound?this.selected=this.board[i.y][i.x]:this.selected=null}},onTouchMove:function(e){if(this.ingameCtor.isPlaying&&this.selected){var t=this.node.convertToNodeSpaceAR(e.getLocation()),i=o.default.tileCoordsFromlocalPosition(t.x,t.y);!i.spriteInBound||this.selected.x===i.x&&this.selected.y===i.y||Math.abs(i.x-this.selected.x)+Math.abs(i.y-this.selected.y)<=1&&(this.swapTileAtCell(this.selected,this.board[i.y][i.x]),this.selected=null)}},onTouchEnded:function(){this.ingameCtor.isPlaying&&(this.selected=null)}}),cc._RF.pop()},{"./EffectorCtor":"EffectorCtor","./constants":"constants","./libs/helpers":"helpers","./objects/Tile":"Tile"}],ComboBoxItem:[function(e,t){"use strict";cc._RF.push(t,"e3eb2OoYnVNLpiehtkwiOa4","ComboBoxItem"),cc.Class({extends:cc.Component,properties:{label:{default:null,type:cc.Label},_parentCtrl:null,_data:null},setData:function(e,t){this._parentCtrl=e,this._data=t,this.label.string=LocalizationHelper.getText("label_text."+t.languageName)},onClickItemBtn:function(){this._parentCtrl.onClickItemBtn(),this._data.languageCode!=LocalizationHelper.language&&(LocalizationHelper.setLanguage(this._data.languageCode),this._parentCtrl.comboLabel.string=LocalizationHelper.getText("label_text."+this._data.languageName))}}),cc._RF.pop()},{}],ComboBox:[function(e,t){"use strict";cc._RF.push(t,"654288QCkNOzqcBu3xCbhmH","ComboBox");var i=["English","Japanese"],o=["en","ja"];cc.Class({extends:cc.Component,properties:{triangle:cc.Node,comboLabel:cc.Label,dropDown:cc.Node,vLayoutNode:cc.Node,contentNode:cc.Node,itemPrefab:cc.Prefab},onLoad:function(){this.isDropDown=!1},start:function(){this.comboLabel.string="en"==LocalizationHelper.language?LocalizationHelper.getText("label_text.English"):LocalizationHelper.getText("label_text.Japanese")},onClickItemBtn:function(e){this.rotateTriangle(),this.showHideDropDownBox(),this.isDropDown?this.isDropDown=!1:this.isDropDown=!0,e&&this.initItems()},rotateTriangle:function(){if(this.isDropDown){var e=cc.rotateTo(.5,-90).easing(cc.easeCubicActionOut());this.triangle.runAction(e)}else{var t=cc.rotateTo(.5,0).easing(cc.easeCubicActionOut());this.triangle.runAction(t)}},showHideDropDownBox:function(){this.isDropDown?this.dropDown.active=!1:this.dropDown.active=!0},initItems:function(){this.vLayoutNode.removeAllChildren();for(var e=0;e<i.length;e++){var t=cc.instantiate(this.itemPrefab);t.getComponent("ComboBoxItem").setData(this,{languageName:i[e],languageCode:o[e]}),this.vLayoutNode.addChild(t)}}}),cc._RF.pop()},{}],EffectorCtor:[function(e,t){"use strict";cc._RF.push(t,"ef9db8BYsdP6a1usAcFMmvG","EffectorCtor");var i=n(e("./constants")),o=n(e("./IngameCtor"));function n(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{ingameController:o.default,scoreFxPrefab:cc.Prefab,timeFxPrefab:cc.Prefab,timeBurstFxPrefab:cc.Prefab},onLoad:function(){this.uiController=this.ingameController.uiController,this.uiTimeBar=this.uiController.timeProgressBar,this.scoreTextPool=new cc.NodePool("scoreText"),this.timeFxPool=new cc.NodePool("timeFx"),this.translatedBoardPos=new cc.v2,this.translatedBoardPos.x=this.ingameController.node.x-this.node.x,this.translatedBoardPos.y=this.ingameController.node.y-this.node.y,this.translatedTimeBarPos=new cc.v2,this.translatedTimeBarPos.x=this.uiTimeBar.node.x+this.uiController.node.x-this.node.x,this.translatedTimeBarPos.y=this.uiTimeBar.node.y+this.uiController.node.y-this.node.y},addScoreFx:function(e,t,o){var n=this;if(this.scoreTextPool.size()<=0){var a=cc.instantiate(this.scoreFxPrefab);this.scoreTextPool.put(a)}var r=this.scoreTextPool.get(),l=r.getComponent(cc.Label);r.color="time"===t?new cc.color("#FECA05"):new cc.color("#ffffff"),l.string="+"+o,r.parent=this.node,r.position=e,r.opacity=255,cc.tween(r).to(i.default.ANIMATE_DURATION_SCORE_TEXT,{position:{value:cc.v2(e.x-5+10*Math.random(),e.y+30*Math.random()+50),easing:"sineOutIn"},opacity:{value:0,easing:"sineOutIn"}}).call(function(){n.scoreTextPool.put(r)}).start()},addTimeBonusFx:function(e,t,i){var o=this;if(this.timeFxPool.size()<=0){var n=cc.instantiate(this.timeFxPrefab);this.timeFxPool.put(n)}var a=this.timeFxPool.get();a.parent=this.node,a.position=this.translatedBoardPos.add(e);var r=.4+.4*Math.random(),l=Math.random();a.getComponent(cc.MotionStreak).fadeTime=.8*r;var s=cc.tween,c=this.calculateCurrentTimeBarPos();s(a).parallel(s().to(r,{x:{value:c.x,easing:l>.5?"sineInOut":"linear"}}),s().to(r,{y:{value:c.y,easing:l>.5?"linear":"sineInOut"}})).call(function(){o.addScoreFx(o.calculateCurrentTimeBarPos(),"time",t),a.destroy();var e=cc.instantiate(o.timeBurstFxPrefab);e.parent=o.node,e.position=c,i()}).start()},calculateCurrentTimeBarPos:function(){return cc.v2(this.translatedTimeBarPos.x+(this.uiTimeBar.progress-.5)*this.uiTimeBar.node.width,this.translatedTimeBarPos.y)}}),cc._RF.pop()},{"./IngameCtor":"IngameCtor","./constants":"constants"}],IngameCtor:[function(e,t){"use strict";cc._RF.push(t,"14ba6kJELlDmpaThJABQGdw","IngameCtor"),a(e("./BoardCtor"));var i=a(e("./constants")),o=a(e("./libs/helpers")),n=a(e("./UICtor"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{uiController:n.default,tutorialFrames:[cc.Node],loading:cc.Node,isPlaying:{get:function(){return this._isGameStart&&!this._isAnimating&&!this._isPaused}},tutorialStep:{get:function(){return this._tutorialStep},set:function(e){this._tutorialStep=e}},isInTutorial:{get:function(){return this._tutorialStep<i.default.TUTORIAL_MOVES.length}}},onLoad:function(){this.board=this.getComponent("BoardCtor"),this.soundController=this.getComponent("SoundCtor"),this.uiController.ingameController=this,this.isAdShown=!1,this.soundController.init(),this.uiController.updateSoundToggle(this.soundController.sound)},start:function(){this._isGameStart=!1,this._isAnimating=!1,this.loading.active=!1,window.tutorial=window.tutorial||!1,this._tutorialStep=window.tutorial?i.default.TUTORIAL_MOVES.length:0,this.tutorialFrames.forEach(function(e){e.active=!1}),this.board.init(),this._level=0,this._score=0,this.setNewLevel()},resetLevelInfo:function(){this._startTime=o.default.getLevelTime(this._level),this._time=o.default.getLevelTime(this._level),this._targetScore=o.default.getLevelScore(this._level),this.uiController.updateStartTime(this._startTime),this.uiController.updateTime(this._time),this.uiController.updateTargetScore(this._targetScore),this.uiController.updateScore(this._score)},update:function(e){var t=this;if(this._isGameStart&&!this.isInTutorial)if(this._time-=1e3*e,this.uiController.updateTime(this._time),this._time<=0&&!this._isAnimating)this.endGame();else if(this._time<1e4){var i=this._time/1e3;i+e>Math.ceil(i)&&(this.soundController.play(this.soundController.tickClip),this._time<5e3&&this.scheduleOnce(function(){t.soundController.play(t.soundController.tickClip)},.5))}},addScore:function(e){this._score+=e,this.uiController.updateScore(this._score)},addTime:function(e){this._time=Math.min(this._time+1e3*e,this._startTime),this.uiController.updateTime(this._time)},checkForLevelCompleted:function(){return this._score>=this._targetScore},pauseGameForAnimating:function(){this._isAnimating=!0,this.tutorialFrames.forEach(function(e){e.active=!1})},resumeGameFromAnimating:function(){this._isAnimating=!1,this.isInTutorial&&(this.tutorialFrames[this._tutorialStep].active=!0)},nextLevel:function(){var e=this;this._level++,this._isGameStart=!1,this.board.animateReshuffleBoard(),this.scheduleOnce(function(){e.soundController.play(e.soundController.nextLevelClip)},i.default.ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW+i.default.ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW*i.default.BOARD_ROW_SIZE*.2),this.scheduleOnce(function(){e.setNewLevel()},i.default.ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW+i.default.ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW*i.default.BOARD_ROW_SIZE)},setNewLevel:function(){var e=this;this.uiController.showNextLevelNotification(this._level),this.uiController.updateLevel(this._level),this.scheduleOnce(function(){e.resetLevelInfo(),e.board.currentChain=0,e.pauseGameForAnimating(),e.board.generateTiles(0===e._tutorialStep&&0===e._level,!1),e.scheduleOnce(function(){e._isGameStart=!0},i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW+i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW*i.default.BOARD_ROW_SIZE)},i.default.ANIMATE_DURATION_NOTIF_SHOW+i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL)},pauseGame:function(){this.isInTutorial||(this._isPaused=!0,this.uiController.show("pause"),this.scheduleOnce(function(){cc.director.pause()},i.default.ANIMATE_DURATION_POPUP_SHOW))},resumeGame:function(){cc.director.resume(),this._isPaused=!1,this.uiController.hide("pause")},endGame:function(){var e=this;this._isGameStart=!1,this.soundController.play(this.soundController.gameOverClip),this.uiController.shoWOutOfTimeNotification(),this.scheduleOnce(function(){e.uiController.updateResultValue(e._level,e._score,e._targetScore),e.uiController.show("result")},i.default.ANIMATE_DURATION_NOTIF_SHOW+i.default.ANIMATE_DURATION_NOTIF_WAIT+i.default.ANIMATE_DURATION_NOTIF_HIDE)},restartGame:function(){var e=this;this.isAdShown||(this.isAdShown=!0,this.soundController.prepareForAd(),this.loading.active=!0,o.default.showAds("reward",!0,function(t){var i=new Object;i.adType="Reward",i.gameName=o.default.getAppName(),i.gameFeature="rewardAD_rePlay",i.weblinkSource=o.default.getWeblinkSource(),t?o.default.gtaPushEvent("AdShowSuccess",i):o.default.gtaPushEvent("AdShowFail",i),e.isAdShown=!1,cc.director.resume(),e.soundController.playBgmSound(),e.loading.active=!1,cc.director.loadScene("ingame")}))},quitGame:function(){this.isAdShown||(this.isAdShown=!0,this.soundController.prepareForAd(),o.default.showAds("reward",!0,function(e){var t=new Object;t.adType="Reward",t.gameName=o.default.getAppName(),t.gameFeature="rewardAD_home",t.weblinkSource=o.default.getWeblinkSource(),e?o.default.gtaPushEvent("AdShowSuccess",t):o.default.gtaPushEvent("AdShowFail",t),cc.director.resume(),cc.director.loadScene("landing")}))},onToggleSound:function(){this.soundController.toggleSound(),this.uiController.updateSoundToggle(this.soundController.sound)}}),cc._RF.pop()},{"./BoardCtor":"BoardCtor","./UICtor":"UICtor","./constants":"constants","./libs/helpers":"helpers"}],LandingCtor:[function(e,t){"use strict";cc._RF.push(t,"55339on/wRL07IkyMYu8FJw","LandingCtor");var i=e("h5ad"),o=e("./libs/helpers");cc.Class({extends:cc.Component,properties:{soundButtonSprite:cc.Sprite,soundOnSprite:cc.SpriteFrame,soundOffSprite:cc.SpriteFrame,openingAnimation:cc.Animation},onLoad:function(){var e=this;LocalizationHelper.init(),this.soundController=this.getComponent("SoundCtor"),this.node.active=!1,o.gtaInit("321085","0033cb7f59e3cd9a32e9a1abd8807afa");var t={weblinkSource:o.getWeblinkSource(),gameName:o.getAppName(),version:"1.0.0"};o.gtaSetUserProperties(t),o.gtaPushEvent("gameSession",t),i._splashAdShown?(this.node.active=!0,this.openingAnimation.play(),this.soundController.init(),this.updateSoundToggle()):i.onStart({icon:o.getResourceUrl("icon"),color:"#3189DD",afterBreak:function(){var t=new Object;t.adType="Interstitial",t.gameName=o.getAppName(),t.weblinkSource=o.getWeblinkSource(),t.gameFeature="interstitialAD_start",o.gtaPushEvent("AdShowSuccess",t),e.node.active=!0,e.openingAnimation.play(),e.soundController.init(),e.updateSoundToggle()},adBreakTimeout:3e3})},start:function(){},onPlayClicked:function(){cc.director.loadScene("ingame")},onToggleSoundClicked:function(){this.soundController.toggleSound(),this.updateSoundToggle(this.soundController.sound)},updateSoundToggle:function(){this.soundButtonSprite.spriteFrame=this.soundController.sound?this.soundOnSprite:this.soundOffSprite}}),cc._RF.pop()},{"./libs/helpers":"helpers",h5ad:1}],LanguageData:[function(e,t){"use strict";cc._RF.push(t,"61de062n4dJ7ZM9/Xdumozn","LanguageData");var i=e("polyglot.min"),o=null;function n(e){return window.i18n.languages[e]}function a(e){e&&(o?o.replace(e):o=new i({phrases:e,allowMissing:!0}))}window.i18n||(window.i18n={languages:{},curLang:""}),t.exports={init:function(e){if(e!==window.i18n.curLang){var t=n(e)||{};window.i18n.curLang=e,a(t),this.inst=o}},t:function(e,t){if(o)return o.t(e,t)},inst:o,updateSceneRenderers:function(){for(var e=cc.director.getScene().children,t=[],i=0;i<e.length;++i){var o=e[i].getComponentsInChildren("LocalizedLabel");Array.prototype.push.apply(t,o)}for(var n=0;n<t.length;++n){var a=t[n];a.node.active&&a.updateLabel()}for(var r=[],l=0;l<e.length;++l){var s=e[l].getComponentsInChildren("LocalizedSprite");Array.prototype.push.apply(r,s)}for(var c=0;c<r.length;++c){var u=r[c];u.node.active&&u.updateSprite(window.i18n.curLang)}}},cc._RF.pop()},{"polyglot.min":"polyglot.min"}],LocalizationHelper:[function(e,t){"use strict";cc._RF.push(t,"fe46fQs9fJFnZhJJkECJfLR","LocalizationHelper");var i=function(){function t(){this.languageData=null}var i=t.prototype;return i.init=function(){this.language=cc.sys.localStorage.getItem("animalflash_lang"),this.language||(this.language=this._getBrowserLanguage()),cc.sys.localStorage.setItem("animalflash_lang",this.language),this.languageData=e("LanguageData"),this.languageData.init(this.language)},i.getText=function(e){return this.languageData.t(e)},i.setLanguage=function(e){this.language=e,cc.sys.localStorage.setItem("animalflash_lang",this.language),this.languageData.init(this.language),this.languageData.updateSceneRenderers()},i._getBrowserLanguage=function(){var e,t,i=window.navigator,o=["language","browserLanguage","systemLanguage","userLanguage"];if(Array.isArray(i.languages))for(e=0;e<i.languages.length;e++)if((t=i.languages[e])&&t.length)return t.slice(0,2);for(e=0;e<o.length;e++)if((t=i[o[e]])&&t.length)return t.slice(0,2);return null},t}();t.exports=new i,window.LocalizationHelper=e("LocalizationHelper"),cc._RF.pop()},{LanguageData:"LanguageData",LocalizationHelper:"LocalizationHelper"}],LocalizedLabel:[function(e,t){"use strict";cc._RF.push(t,"744dcs4DCdNprNhG0xwq6FK","LocalizedLabel");var i=e("LanguageData");cc.Class({extends:cc.Component,editor:{executeInEditMode:!0,menu:"i18n/LocalizedLabel"},properties:{dataID:{get:function(){return this._dataID},set:function(e){this._dataID!==e&&(this._dataID=e,this.updateLabel())}},_dataID:""},onLoad:function(){i.inst||i.init(),this.fetchRender()},fetchRender:function(){var e=this.getComponent(cc.Label);if(e)return this.label=e,void this.updateLabel()},updateLabel:function(){this.label?i.t(this.dataID)&&(this.label.string=i.t(this.dataID)):cc.error("Failed to update localized label, label component is invalid!")}}),cc._RF.pop()},{LanguageData:"LanguageData"}],LocalizedSprite:[function(e,t){"use strict";cc._RF.push(t,"f34ac2GGiVOBbG6XlfvgYP4","LocalizedSprite");var i=e("SpriteFrameSet");cc.Class({extends:cc.Component,editor:{executeInEditMode:!0,inspector:"packages://i18n/inspector/localized-sprite.js",menu:"i18n/LocalizedSprite"},properties:{spriteFrameSet:{default:[],type:i}},onLoad:function(){this.fetchRender()},fetchRender:function(){var e=this.getComponent(cc.Sprite);if(e)return this.sprite=e,void this.updateSprite(window.i18n.curLang)},getSpriteFrameByLang:function(e){for(var t=0;t<this.spriteFrameSet.length;++t)if(this.spriteFrameSet[t].language===e)return this.spriteFrameSet[t].spriteFrame},updateSprite:function(e){if(this.sprite){var t=this.getSpriteFrameByLang(e);!t&&this.spriteFrameSet[0]&&(t=this.spriteFrameSet[0].spriteFrame),this.sprite.spriteFrame=t}else cc.error("Failed to update localized sprite, sprite component is invalid!")}}),cc._RF.pop()},{SpriteFrameSet:"SpriteFrameSet"}],SoundCtor:[function(e,t){"use strict";cc._RF.push(t,"6d283BBWK5NdIbg0yIz1Xbd","SoundCtor");var i=e("h5ad");cc.Class({extends:cc.Component,properties:{bgm:cc.AudioClip,nextLevelClip:cc.AudioClip,swapClip:cc.AudioClip,dropClip:cc.AudioClip,adjoinClip:cc.AudioClip,specialAdjoinClip:cc.AudioClip,timeAdjoinClip:cc.AudioClip,tickClip:cc.AudioClip,gameOverClip:cc.AudioClip,sound:{get:function(){return"on"===this._sound}}},init:function(){this._sound=cc.sys.localStorage.getItem("massplay.animalFlash.sound")||"on",cc.audioEngine.setMusicVolume(.6),this.playBgmSound()},toggleSound:function(){this._sound=this.sound?"off":"on",cc.sys.localStorage.setItem("massplay.animalFlash.sound",this._sound),this.playBgmSound()},playBgmSound:function(){cc.audioEngine.isMusicPlaying()&&!this.sound?cc.audioEngine.stopAll():!cc.audioEngine.isMusicPlaying()&&this.sound&&cc.audioEngine.playMusic(this.bgm,!0)},play:function(e){var t=this;if(this.sound)if(e===this.nextLevelClip)cc.audioEngine.stopMusic(),cc.audioEngine.play(e,!1,.5),setTimeout(function(){t.playBgmSound()},3e3);else if(e===this.gameOverClip)cc.audioEngine.stopMusic(),cc.audioEngine.play(e,!1,.5);else if(e===this.dropClip){if(!this.isDropClipPlaying){var i=cc.audioEngine.playEffect(e,!1,.8);this.isDropClipPlaying=!0;var o=cc.audioEngine.getDuration(i);setTimeout(function(){t.isDropClipPlaying=!1},o)}}else e===this.timeAdjoinClip?(i=null,setTimeout(function(){i=cc.audioEngine.playEffect(e,!1,.8)},200),setTimeout(function(){i&&cc.audioEngine.stop(i)},1200)):cc.audioEngine.playEffect(e,!1,.8)},prepareForAd:function(){cc.audioEngine.stopAll(),this.sound?i.onUnmute():i.onMute()}}),cc._RF.pop()},{h5ad:1}],SpriteFrameSet:[function(e,t){"use strict";cc._RF.push(t,"97019Q80jpE2Yfz4zbuCZBq","SpriteFrameSet");var i=cc.Class({name:"SpriteFrameSet",properties:{language:"",spriteFrame:cc.SpriteFrame}});t.exports=i,cc._RF.pop()},{}],Tile:[function(e,t){"use strict";cc._RF.push(t,"d4edekFanxESLFqIaLf7XiX","Tile");var i=n(e("../libs/helpers")),o=n(e("../constants"));function n(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{typeSpriteFrames:[cc.SpriteFrame],debugLabel:cc.Label},start:function(){},setup:function(e,t){this.type=e,this.cell=t,this.isSpecial=this.type>=o.default.TILE_TYPE_NORMAL_NUMBER,this.getComponent(cc.Sprite).spriteFrame=this.typeSpriteFrames[e];var n=i.default.localPositionFromTileCoords(t.x,t.y);this.node.scale=this.getDefaultScale(),this.node.opacity=255,this.node.x=n.x,this.node.y=n.y,this.node.width=o.default.TILE_SPRITE_SIZE,this.node.height=o.default.TILE_SPRITE_SIZE,this.debugLabel.node.active=!1,this.unhighlight()},hightlight:function(){this.tween&&this.tween.stop(),this.tween=cc.tween(this.node).repeatForever(cc.tween().to(.5,{color:new cc.color(o.default.TILE_HINT_COLOR)}).to(.5,{color:new cc.color("#000000")})).start()},unhighlight:function(){this.tween&&(this.tween.stop(),cc.tween(this.node).to(.2,{color:new cc.color("#000000")}).start())},update:function(){this.debugLabel.string="("+this.cell.x+", "+this.cell.y+")\n"+this.type},getDefaultScale:function(){return this.isSpecial?o.default.TILE_SPECIAL_SCALE:1}}),cc._RF.pop()},{"../constants":"constants","../libs/helpers":"helpers"}],UICtor:[function(e,t){"use strict";cc._RF.push(t,"32604sN3YpLH7A3Rg8oHRNn","UICtor");var i=n(e("./constants")),o=n(e("./libs/helpers"));function n(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{timeProgressBar:cc.ProgressBar,scoreProgressBar:cc.ProgressBar,scoreLabel:cc.Label,targetScoreLabel:cc.Label,timeMinLabel:cc.Label,timeSecLabel:cc.Label,roundLabel:cc.Label,roundResultLabel:cc.Label,scoreResultLabel:cc.Label,targetScoreResultLabel:cc.Label,popupOverlay:cc.Node,pausePopup:cc.Node,resultPopup:cc.Node,reshuffleNotification:cc.Node,nextLevelNotification:cc.Node,nextLevelNotificationAnimationFrame:cc.Node,nextLevelNotificationEffect:cc.Node,nextLevelNotificationLeftProp:cc.Node,nextLevelNotificationRightProp:cc.Node,nextLevelNotificationLabel:cc.Label,timeoutNotification:cc.Node,soundButtonSprite1:cc.Sprite,soundButtonSprite2:cc.Sprite,soundOnSprite:cc.SpriteFrame,soundOffSprite:cc.SpriteFrame},onLoad:function(){this.popupOverlay.active=!1,this.pausePopup.active=!1,this.resultPopup.active=!1,this.reshuffleNotification.active=!1,this.nextLevelNotification.active=!1,this.timeoutNotification.active=!1},start:function(){},updateStartTime:function(e){this.startTime=e},updateLevel:function(e){this.roundLabel.string=e+1},updateTime:function(e){e=Math.max(0,e);var t=o.default.formatTimer(e);this.timeMinLabel.string=t.minute,this.timeSecLabel.string=t.second;var i=e/this.startTime;this.timeProgressBar.progress=i},updateTargetScore:function(e){this.targetScore=e,this.targetScoreLabel.string=e},updateScore:function(e){this.scoreLabel.string=e;var t=e/this.targetScore;this.scoreProgressBar.progress=t},updateResultValue:function(e,t,i){this.roundResultLabel.string=e+1,this.targetScoreResultLabel.string=i,this.scoreResultLabel.string=t},show:function(e){this.popupOverlay.active=!0;var t=null;switch(e){case"pause":t=this.pausePopup;break;case"result":t=this.resultPopup}null!==t&&(t.active=!0,t.scale=0,cc.tween(t).to(i.default.ANIMATE_DURATION_POPUP_SHOW,{scale:1}).start())},hide:function(e){this.popupOverlay.active=!1;var t=null;switch(e){case"pause":t=this.pausePopup;break;case"result":t=this.resultPopup}null!==t&&cc.tween(t).to(i.default.ANIMATE_DURATION_POPUP_SHOW,{scale:0}).call(function(){t.active=!0}).start()},showNextLevelNotification:function(e){var t=this;this.nextLevelNotificationLabel.string=""+(e+1),this.nextLevelNotification.active=!0,this.nextLevelNotificationAnimationFrame.opacity=0,this.nextLevelNotificationAnimationFrame.y=-100,this.nextLevelNotificationEffect.scale=0;var o=cc.tween(this.nextLevelNotificationEffect).parallel(cc.tween().to(.5,{scale:1}),cc.tween().repeatForever(cc.tween().by(5,{angle:360}))).start();cc.tween(this.nextLevelNotificationEffect).delay(i.default.ANIMATE_DURATION_NOTIF_SHOW+i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL-.3).to(.3,{scale:.3}).call(function(){t.nextLevelNotificationEffect.scale=0,o.stop()}).start();var n=cc.v2(5*Math.random()+10,10*Math.random()+20),a=cc.v2(5*Math.random()+10,10*Math.random()+20),r=cc.v2(5*Math.random()+10,10*Math.random()+20),l=cc.v2(5*Math.random()+10,10*Math.random()+20);cc.tween(this.nextLevelNotificationLeftProp).delay(i.default.ANIMATE_DURATION_NOTIF_SHOW-.3*Math.random()).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/4,{x:-n.x,y:n.y}).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/4,{x:n.x,y:-n.y}).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/3.4,{x:-a.x,y:a.y}).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/3.4,{x:a.x,y:-a.y}).start(),cc.tween(this.nextLevelNotificationRightProp).delay(i.default.ANIMATE_DURATION_NOTIF_SHOW-.3*Math.random()).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/3.4,{x:r.x,y:r.y}).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/3.4,{x:-r.x,y:-r.y}).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/4,{x:l.x,y:l.y}).by(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL/4,{x:-l.x,y:-l.y}).start(),cc.tween(this.nextLevelNotificationAnimationFrame).to(i.default.ANIMATE_DURATION_NOTIF_SHOW,{position:cc.v2(0,0),opacity:255}).delay(i.default.ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL).to(i.default.ANIMATE_DURATION_NOTIF_HIDE,{position:cc.v2(0,-100),opacity:0}).start()},showReshuffleNotification:function(){this.reshuffleNotification.active=!0,this.reshuffleNotification.opacity=0,this.reshuffleNotification.y=-140,cc.tween(this.reshuffleNotification).to(i.default.ANIMATE_DURATION_NOTIF_SHOW,{position:cc.v2(0,-40),opacity:255}).delay(i.default.ANIMATE_DURATION_NOTIF_WAIT).to(i.default.ANIMATE_DURATION_NOTIF_HIDE,{position:cc.v2(0,-140),opacity:0}).start()},shoWOutOfTimeNotification:function(){this.timeoutNotification.active=!0,this.timeoutNotification.opacity=0,this.timeoutNotification.y=-140,cc.tween(this.timeoutNotification).to(i.default.ANIMATE_DURATION_NOTIF_SHOW,{position:cc.v2(0,-40),opacity:255}).delay(i.default.ANIMATE_DURATION_NOTIF_WAIT).to(i.default.ANIMATE_DURATION_NOTIF_HIDE,{position:cc.v2(0,-140),opacity:0}).start()},updateSoundToggle:function(e){this.soundButtonSprite1.spriteFrame=e?this.soundOnSprite:this.soundOffSprite,this.soundButtonSprite2.spriteFrame=e?this.soundOnSprite:this.soundOffSprite},pauseClicked:function(){this.ingameController.pauseGame()},resumeClicked:function(){this.ingameController.resumeGame()},quitClicked:function(){this.ingameController.quitGame()},restartClicked:function(){this.ingameController.restartGame()},onSoundClicked:function(){this.ingameController.onToggleSound()}}),cc._RF.pop()},{"./constants":"constants","./libs/helpers":"helpers"}],constants:[function(e,t,i){"use strict";cc._RF.push(t,"027081N1wNHhZgaQobZoi8J","constants"),i.__esModule=!0,i.default=void 0,i.default={TILE_TYPE_NORMAL_NUMBER:5,TILE_TYPE_INDEX_SPECIAL_LINE:5,TILE_TYPE_INDEX_SPECIAL_TIME:6,TILE_TYPE_INDEX_SPECIAL_MATCH:7,TILE_TYPE_INDEX_SPECIAL_ROCK:8,TILE_SPECIAL_SCALE:1.3,TILE_SPECIAL_BONUS_TIME:15,TILE_SIZE:72,TILE_SPRITE_SIZE:64,BOARD_COLUMN_SIZE:7,BOARD_ROW_SIZE:7,TILE_HINT_COLOR:"333300",TILE_HINT_SHOWUP_TIME:3,SCORING:[40,60,80,100,150,180,200],SPECIAL_SCORING:120,LEVEL_SCORE:[3e3,6e3,1e4,15e3,21e3,28e3,35e3,42e3,49e3,56e3,61e3,68e3,75e3,82e3,9e4],LEVEL_TIME:[180,150,120,105,90,75,60,45,30],ANIMATE_DURATION_SWAP:.2,ANIMATE_DURATION_ADJOIN:.2,ANIMATE_DURATION_SPAWN_SPECIAL:.2,ANIMATE_DURATION_DROP_TILES:.25,ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW:.4,ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW:.14,ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW:.36,ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW:.1,ANIMATE_DURATION_SCORE_TEXT:.6,ANIMATE_DURATION_POPUP_SHOW:.2,ANIMATE_DURATION_NOTIF_SHOW:.3,ANIMATE_DURATION_NOTIF_WAIT:1,ANIMATE_DURATION_NOTIF_WAIT_NEXT_LEVEL:1,ANIMATE_DURATION_NOTIF_HIDE:.3,TUTORIAL_LAYOUT:[[0,1,2,3,2,0,1],[3,4,0,1,4,3,4],[1,2,3,4,0,4,3],[4,0,4,3,3,2,2],[2,3,2,0,1,0,1],[4,0,1,2,3,4,0],[3,4,0,1,2,3,4]],TUTORIAL_MOVES:[[{x:2,y:2},{x:2,y:3}],[{x:4,y:1},{x:4,y:2}],[{x:3,y:2},{x:4,y:2}]]},t.exports=i.default,cc._RF.pop()},{}],helpers:[function(e,t){"use strict";cc._RF.push(t,"25b0ch0ZN5CTrLtkqwGvZ7C","helpers");var i,o=(i=e("../constants"))&&i.__esModule?i:{default:i},n=e("h5ad"),a=!1;t.exports.getScoreScale=function(e){return o.default.SCORING[Math.min(e,o.default.SCORING.length-1)]},t.exports.localPositionFromTileCoords=function(e,t){return cc.v2((e-o.default.BOARD_COLUMN_SIZE/2+.5)*o.default.TILE_SIZE,(t-o.default.BOARD_ROW_SIZE/2+.5)*o.default.TILE_SIZE)},t.exports.tileCoordsFromlocalPosition=function(e,t){var i=o.default.TILE_SPRITE_SIZE/o.default.TILE_SIZE/2,n=(e+(o.default.BOARD_COLUMN_SIZE/2-.5)*o.default.TILE_SIZE)/o.default.TILE_SIZE,a=(t+(o.default.BOARD_ROW_SIZE/2-.5)*o.default.TILE_SIZE)/o.default.TILE_SIZE,r=Math.round(n),l=Math.round(a);return{x:r,y:l,spriteInBound:Math.abs(n-r)<=i&&Math.abs(a-l)<=i&&r>=0&&r<o.default.BOARD_COLUMN_SIZE&&l>=0&&l<o.default.BOARD_ROW_SIZE}},t.exports.formatDurationDHMSObject=function(e){e=Math.max(0,e);var t=Math.ceil(e/1e3),i=Math.floor(t/60),o=Math.floor(i/60),n=Math.floor(o/24);return{seconds:t%=60,minutes:i%=60,hours:o%=24,days:n}},t.exports.formatTimer=function(e){var t=this.formatDurationDHMSObject(e),i=t.seconds,o=t.minutes,n=t.hours,a=t.days,r=o>9||0===n?o:"0"+o,l=i>9?i:"0"+i;return a>=1?a+":"+n+":"+o+":"+i:n>=1?n+":"+r+":"+l:{hour:0,minute:r,second:l}},t.exports.getLevelScore=function(e){return e<o.default.LEVEL_SCORE.length?o.default.LEVEL_SCORE[e]:o.default.LEVEL_SCORE[o.default.LEVEL_SCORE.length-1]+1e4*(e-o.default.LEVEL_SCORE.length+1)},t.exports.getLevelTime=function(e){return 1e3*o.default.LEVEL_TIME[Math.min(e,o.default.LEVEL_TIME.length-1)]},t.exports.showAds=function(e,t,i){var o=new Object;o.type=e,o.beforeBreak=function(){console.log("beforeBreak"),t&&(cc.director.pause(),cc.audioEngine.pauseAll())},o.afterBreak=function(){console.log("afterBreak"),t&&(cc.director.resume(),cc.audioEngine.resumeAll()),"reward"!=e&&i&&i(!0)},"reward"==e&&(o.beforeReward=function(e){console.log("beforeReward"),e()}),o.adDismissed=function(){console.log("adDismissed"),i&&i(!1)},"reward"==e&&(o.adViewed=function(){console.log("adViewed"),i&&i(!0)}),o.noBreak=function(){console.log("noBreak"),t&&(cc.director.resume(),cc.audioEngine.resumeAll()),i&&i(!0)},n.adBreak(o)},t.exports.getResourceUrl=function(e){var t=cc.resources.getInfoWithPath(e),i=t.uuid;return t.nativeVer&&(i+="."+t.nativeVer),"./assets/resources/native/"+i.substr(0,2)+"/"+i+".png"},t.exports.gtaInit=function(e,t){if(!a){console.log("init:",e+" ** "+t);var i={gameId:e,version:"1.0.0",debugLog:!0,amplitude:{apiKey:t,debugLog:!0}};gcTurboAnalytics.init(i),a=!0}},t.exports.gtaSendBaseUserProperties=function(){var e=new Object;e.version="1.0.0",gcTurboAnalytics.setUserProperties(e)},t.exports.gtaSetUserProperties=function(e){gcTurboAnalytics.setUserProperties(e)},t.exports.gtaPushEvent=function(e,t){gcTurboAnalytics.pushEvent(e,t)},t.exports.getAppName=function(){return"Animal Flash"},t.exports.getWeblinkSource=function(){return document?document.referrer||document.URL:"Unknown"},cc._RF.pop()},{"../constants":"constants",h5ad:1}],"polyglot.min":[function(e,t,i){"use strict";cc._RF.push(t,"e26fd9yy65A4q3/JkpVnFYg","polyglot.min"),function(e,o){"function"==typeof define&&define.amd?define([],function(){return o(e)}):"object"==typeof i?t.exports=o(e):e.Polyglot=o(e)}(void 0,function(e){function t(e){e=e||{},this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en",this.allowMissing=!!e.allowMissing,this.warn=e.warn||s}function i(e){var t,i,o,n={};for(t in e)if(e.hasOwnProperty(t))for(o in i=e[t])n[i[o]]=t;return n}function o(e){return e.replace(/^\s+|\s+$/g,"")}function n(e,t,i){var n;return null!=i&&e?o((n=e.split(u))[r(t,i)]||n[0]):e}function a(e){var t=i(h);return t[e]||t.en}function r(e,t){return d[a(e)](t)}function l(e,t){for(var i in t)"_"!==i&&t.hasOwnProperty(i)&&(e=e.replace(new RegExp("%\\{"+i+"\\}","g"),t[i]));return e}function s(t){e.console&&e.console.warn&&e.console.warn("WARNING: "+t)}function c(e){var t={};for(var i in e)t[i]=e[i];return t}t.VERSION="0.4.3",t.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},t.prototype.extend=function(e,t){var i;for(var o in e)e.hasOwnProperty(o)&&(i=e[o],t&&(o=t+"."+o),"object"==typeof i?this.extend(i,o):this.phrases[o]=i)},t.prototype.clear=function(){this.phrases={}},t.prototype.replace=function(e){this.clear(),this.extend(e)},t.prototype.t=function(e,t){var i,o;return"number"==typeof(t=null==t?{}:t)&&(t={smart_count:t}),"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof t._?i=t._:this.allowMissing?i=e:(this.warn('Missing translation for key: "'+e+'"'),o=e),"string"==typeof i&&(t=c(t),o=l(o=n(i,this.currentLocale,t.smart_count),t)),o},t.prototype.has=function(e){return e in this.phrases};var u="||||",d={chinese:function(){return 0},german:function(e){return 1!==e?1:0},french:function(e){return e>1?1:0},russian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0}},h={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};return t}),cc._RF.pop()},{}]},{},["BoardCtor","EffectorCtor","IngameCtor","LandingCtor","SoundCtor","UICtor","constants","ComboBox","ComboBoxItem","LocalizationHelper","helpers","Tile","LanguageData","LocalizedLabel","LocalizedSprite","SpriteFrameSet","polyglot.min"]);